# This Makefile was generated by the Cake3
# https://github.com/grwlf/cake3

GUARD = .cake3/GUARD_$(1)_$(shell echo $($(1)) | md5sum | cut -d ' ' -f 1)

ifeq ($(MAIN),1)
unexport MAIN

# Main section

LIBJANSSON = $(shell pkg-config --libs jansson)
LIBLIBCURL = $(shell pkg-config --libs libcurl)
URVERSION = $(shell urweb -version)
UR_CC = $(shell $(shell urweb -print-ccompiler) -print-prog-name=gcc)
UR_INCL = -I$(shell urweb -print-cinclude)
.PHONY: ./all
./all: ./Makefile.dev ./lib.urp ./test/P1.exe
./.cake3/tmp___test_P1_in_2: ./Makefile.dev ./lib.urp ./test/P1.ur
	( \
	echo   ;\
	echo \.\.\/test\/P1  ;\
	) > ./.cake3/tmp___test_P1_in_2
./.cake3/tmp___test_P1_in_1: ./Makefile.dev ./lib.urp ./test/P1.ur
	( \
	echo library\ \.\.\/  ;\
	echo safeGet\ P1\/main  ;\
	echo debug  ;\
	) > ./.cake3/tmp___test_P1_in_1
./.cake3/tmp___lib_in_2: ./.cake3/tmp___urweb_persona_js_patch ./Makefile.dev ./autogen/urweb_persona_js.ur ./autogen/urweb_persona_js_c.c ./autogen/urweb_persona_js_c.h ./autogen/urweb_persona_js_c.o ./autogen/urweb_persona_js_c.urs ./ffi.h ./ffi.o ./persona.ur ./persona.urs ../Uru/lib.urp
	( \
	echo   ;\
	echo \.\/autogen\/urweb\_persona\_js  ;\
	echo \.\/persona  ;\
	) > ./.cake3/tmp___lib_in_2
./.cake3/tmp___lib_in_1: ./.cake3/tmp___urweb_persona_js_patch ./Makefile.dev ./autogen/urweb_persona_js.ur ./autogen/urweb_persona_js_c.c ./autogen/urweb_persona_js_c.h ./autogen/urweb_persona_js_c.o ./autogen/urweb_persona_js_c.urs ./ffi.h ./ffi.o ./persona.ur ./persona.urs ../Uru/lib.urp
	( \
	echo allow\ mime\ text\/javascript  ;\
	echo database\ dbname\=persona  ;\
	echo sql\ \.\/persona\.sql  ;\
	echo script\ https\:\/\/login\.persona\.org\/include\.js  ;\
	echo ffi\ \.\/personaFfi  ;\
	echo jsFunc\ PersonaFfi\.request\ \=\ request  ;\
	echo jsFunc\ PersonaFfi\.logout\ \=\ logout  ;\
	echo jsFunc\ PersonaFfi\.watch\ \=\ watch  ;\
	echo ffi\ \.\/ffi  ;\
	echo link\ \%JANSSON\%  ;\
	echo link\ \%LIBCURL\%  ;\
	echo include\ \.\/ffi\.h  ;\
	echo safeGet\ Persona\/signin  ;\
	echo safeGet\ Persona\/signout  ;\
	echo allow\ responseHeader\ X\-UA\-Compatible  ;\
	echo ffi\ \.\/autogen\/urweb\_persona\_js\_c  ;\
	echo include\ \.\/autogen\/urweb\_persona\_js\_c\.h  ;\
	echo link\ \.\/autogen\/urweb\_persona\_js\_c\.o  ;\
	echo safeGet\ Persona\/main  ;\
	echo safeGet\ Persona\/persjs  ;\
	echo safeGet\ Persona\/add  ;\
	echo library\ \.\.\/Uru\/  ;\
	echo debug  ;\
	echo safeGet\ PersonaFfi\/request  ;\
	echo safeGet\ PersonaFfi\/logout  ;\
	echo link\ \.\/ffi\.o  ;\
	) > ./.cake3/tmp___lib_in_1
./.cake3/tmp____Uru_lib_in_2: ./Makefile.dev ../Uru/CSS.ur ../Uru/CSS.urs ../Uru/Script.h ../Uru/Script.o ../Uru/Uru.ur ../Uru/Uru.urs
	( \
	echo   ;\
	echo $$\/list  ;\
	echo \.\/CSS  ;\
	echo \.\/Uru  ;\
	) > ./.cake3/tmp____Uru_lib_in_2
./.cake3/tmp____Uru_lib_in_1: ./Makefile.dev ../Uru/CSS.ur ../Uru/CSS.urs ../Uru/Script.h ../Uru/Script.o ../Uru/Uru.ur ../Uru/Uru.urs
	( \
	echo ffi\ \.\/Script  ;\
	echo include\ \.\/Script\.h  ;\
	echo link\ \.\/Script\.o  ;\
	) > ./.cake3/tmp____Uru_lib_in_1
.PHONY: ./lib
./lib: ./Makefile.dev ./lib.urp
./.cake3/tmp___urweb_persona_js_patch: ./.fix-multy1
.INTERMEDIATE: ./.fix-multy1
./.fix-multy1: ./Makefile.dev ./urweb_persona.js
	urembed  -c ./autogen/urweb_persona_js_c.c -H ./autogen/urweb_persona_js_c.h -s ./autogen/urweb_persona_js_c.urs -w ./autogen/urweb_persona_js.ur  ./urweb_persona.js > ./.cake3/tmp___urweb_persona_js_patch
./Cakegen: ../Bootstrap/Cake_Bootstrap.hs ../BootstrapMisc/Cake_BootstrapMisc.hs ../Dialog/Cake_Dialog.hs ../JQuery/Cake_JQ.hs ../Persona/Cake_Persona.hs ../Uru/Cake_URU.hs ./Cake_Persona.hs
	cake3 -C ..
./Makefile.dev: ./Cakegen
	./Cakegen
./autogen/urweb_persona_js.ur: ./.fix-multy1
./autogen/urweb_persona_js_c.c: ./.fix-multy1
./autogen/urweb_persona_js_c.h: ./.fix-multy1
./autogen/urweb_persona_js_c.o: ./.cake3/tmp___urweb_persona_js_patch ./Makefile.dev ./autogen/urweb_persona_js.ur ./autogen/urweb_persona_js_c.c ./autogen/urweb_persona_js_c.h ./autogen/urweb_persona_js_c.urs $(call GUARD,UR_CC) $(call GUARD,UR_INCL)
	$(UR_CC) -c $(UR_INCL) -o ./autogen/urweb_persona_js_c.o ./autogen/urweb_persona_js_c.c
./autogen/urweb_persona_js_c.urs: ./.fix-multy1
./ffi.o: ./Makefile.dev ./ffi.c $(call GUARD,UR_CC) $(call GUARD,UR_CFLAGS) $(call GUARD,UR_INCL)
	$(UR_CC) -c $(UR_INCL) $(UR_CFLAGS) $(shell pkg-config --cflags libcurl) $(shell pkg-config --cflags jansson)  -o ./ffi.o ./ffi.c
./lib.urp: ./.cake3/tmp___lib_in_1 ./.cake3/tmp___lib_in_2 ./.cake3/tmp___urweb_persona_js_patch ./Makefile.dev ./autogen/urweb_persona_js.ur ./autogen/urweb_persona_js_c.c ./autogen/urweb_persona_js_c.h ./autogen/urweb_persona_js_c.urs $(call GUARD,LIBJANSSON) $(call GUARD,LIBLIBCURL)
	cat ./.cake3/tmp___lib_in_1 | sed 's@%LIBCURL%@$(LIBLIBCURL)@' | sed 's@%JANSSON%@$(LIBJANSSON)@' > ./lib.urp
	cat ./.cake3/tmp___urweb_persona_js_patch >> ./lib.urp
	cat ./.cake3/tmp___lib_in_2 >> ./lib.urp
./test/P1.exe: ./Makefile.dev ./test/P1.urp $(call GUARD,URVERSION)
	urweb -dbms sqlite ./test/P1
./test/P1.urp: ./.cake3/tmp___test_P1_in_1 ./.cake3/tmp___test_P1_in_2 ./Makefile.dev
	cat ./.cake3/tmp___test_P1_in_1 > ./test/P1.urp
	cat ./.cake3/tmp___test_P1_in_2 >> ./test/P1.urp
../Uru/Script.o: ./Makefile.dev ../Uru/Script.c $(call GUARD,UR_CC) $(call GUARD,UR_CFLAGS) $(call GUARD,UR_INCL)
	$(UR_CC) -c $(UR_INCL) $(UR_CFLAGS)  -o ../Uru/Script.o ../Uru/Script.c
../Uru/lib.urp: ./.cake3/tmp____Uru_lib_in_1 ./.cake3/tmp____Uru_lib_in_2 ./Makefile.dev
	cat ./.cake3/tmp____Uru_lib_in_1 > ../Uru/lib.urp
	cat ./.cake3/tmp____Uru_lib_in_2 >> ../Uru/lib.urp
$(call GUARD,LIBJANSSON):
	rm -f .cake3/GUARD_LIBJANSSON_*
	touch $@
$(call GUARD,LIBLIBCURL):
	rm -f .cake3/GUARD_LIBLIBCURL_*
	touch $@
$(call GUARD,URVERSION):
	rm -f .cake3/GUARD_URVERSION_*
	touch $@
$(call GUARD,UR_CC):
	rm -f .cake3/GUARD_UR_CC_*
	touch $@
$(call GUARD,UR_CFLAGS):
	rm -f .cake3/GUARD_UR_CFLAGS_*
	touch $@
$(call GUARD,UR_INCL):
	rm -f .cake3/GUARD_UR_INCL_*
	touch $@

else

# Prebuild/postbuild section

ifneq ($(MAKECMDGOALS),clean)

.PHONY: ./all
./all: ./.fix-multy1
.PHONY: ./.cake3/tmp___test_P1_in_2
./.cake3/tmp___test_P1_in_2: ./.fix-multy1
.PHONY: ./.cake3/tmp___test_P1_in_1
./.cake3/tmp___test_P1_in_1: ./.fix-multy1
.PHONY: ./.cake3/tmp___lib_in_2
./.cake3/tmp___lib_in_2: ./.fix-multy1
.PHONY: ./.cake3/tmp___lib_in_1
./.cake3/tmp___lib_in_1: ./.fix-multy1
.PHONY: ./.cake3/tmp____Uru_lib_in_2
./.cake3/tmp____Uru_lib_in_2: ./.fix-multy1
.PHONY: ./.cake3/tmp____Uru_lib_in_1
./.cake3/tmp____Uru_lib_in_1: ./.fix-multy1
.PHONY: ./lib
./lib: ./.fix-multy1
.PHONY: ./.cake3/tmp___urweb_persona_js_patch
./.cake3/tmp___urweb_persona_js_patch: ./.fix-multy1
.INTERMEDIATE: ./.fix-multy1
./.fix-multy1:
	-mkdir .cake3
	MAIN=1 $(MAKE) -f ./Makefile.dev $(MAKECMDGOALS)
.PHONY: ./Cakegen
./Cakegen: ./.fix-multy1
.PHONY: ./Makefile.dev
./Makefile.dev: ./.fix-multy1
.PHONY: ./autogen/urweb_persona_js.ur
./autogen/urweb_persona_js.ur: ./.fix-multy1
.PHONY: ./autogen/urweb_persona_js_c.c
./autogen/urweb_persona_js_c.c: ./.fix-multy1
.PHONY: ./autogen/urweb_persona_js_c.h
./autogen/urweb_persona_js_c.h: ./.fix-multy1
.PHONY: ./autogen/urweb_persona_js_c.o
./autogen/urweb_persona_js_c.o: ./.fix-multy1
.PHONY: ./autogen/urweb_persona_js_c.urs
./autogen/urweb_persona_js_c.urs: ./.fix-multy1
.PHONY: ./ffi.o
./ffi.o: ./.fix-multy1
.PHONY: ./lib.urp
./lib.urp: ./.fix-multy1
.PHONY: ./test/P1.exe
./test/P1.exe: ./.fix-multy1
.PHONY: ./test/P1.urp
./test/P1.urp: ./.fix-multy1
.PHONY: ../Uru/Script.o
../Uru/Script.o: ./.fix-multy1
.PHONY: ../Uru/lib.urp
../Uru/lib.urp: ./.fix-multy1

endif
.PHONY: ./clean
./clean:
	-rm ./.cake3/tmp____Uru_lib_in_1 ./.cake3/tmp____Uru_lib_in_2 ./.cake3/tmp___lib_in_1 ./.cake3/tmp___lib_in_2 ./.cake3/tmp___test_P1_in_1 ./.cake3/tmp___test_P1_in_2 ./.cake3/tmp___urweb_persona_js_patch ./Cakegen ./autogen/urweb_persona_js.ur ./autogen/urweb_persona_js_c.c ./autogen/urweb_persona_js_c.h ./autogen/urweb_persona_js_c.o ./autogen/urweb_persona_js_c.urs ./ffi.o ./lib.urp ./test/P1.exe ./test/P1.urp ../Uru/Script.o ../Uru/lib.urp
	-rm -rf .cake3

endif
